create table geoname_osm_match as select a.geonameid, a.name as geoname, fcode, osmid, osmtype, b.name as osmname, b.feature_class, b.feature_type, similarity(a.name, b.name) as similarity, st_distance_sphere(a.pt, b.pt) as dist from geoname a, osm b, geoname_match c where c.geonameid=a.geonameid and b.pt && setsrid(st_buffer(a.pt,c.dist/111111.1), 4326) and similarity(a.name,b.name) >= c.similarity and st_distance_sphere(a.pt, b.pt) <= c.dist and  similarity(a.name,b.name) > 0.40; 
